{
    "meta": {
        "engine_version": "3.0",
        "last_update": "2026-02-22",
        "threat_model": {
        "framework": "MITRE ATT&CK",
        "version": "14.1",
        "enabled": true,
        "auto_map_missing": true
    },
    "asset_awareness": {
      "enabled": true,
      "rules": {
        "root_user_multiplier": 1.7,
        "system_process_multiplier": 1.4,
        "network_facing_process_multiplier": 1.6,
        "container_process_multiplier": 1.3
      }
    },
    "risk_engine": {
        "enabled": true,
        "base_severity_weights": { "low": 10, "medium": 40, "high": 75, "critical": 95 },
        "risk_escalation": {
            "enabled": true, "repeat_multiplier": 1.25, "time_window_sec": 120, "decay_factor": 0.92, "max_risk_cap": 100
        }
        }
     },
    "exit_codes": {
        "1": {
            "description": "System Error: Operation not permitted",
            "severity": "high",
            "risk_score": 80,
            "category": "security"
        },
        "2": {
            "description": "System Error: No such file or directory",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "3": {
            "description": "System Error: No such process",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "4": {
            "description": "System Error: Interrupted system call",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "5": {
            "description": "System Error: Input/output error",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "6": {
            "description": "System Error: No such device or address",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "7": {
            "description": "System Error: Argument list too long",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "8": {
            "description": "System Error: Exec format error",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "9": {
            "description": "System Error: Bad file descriptor",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "10": {
            "description": "System Error: No child processes",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "11": {
            "description": "System Error: Resource temporarily unavailable",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "12": {
            "description": "System Error: Cannot allocate memory",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "13": {
            "description": "System Error: Permission denied",
            "severity": "high",
            "risk_score": 80,
            "category": "security"
        },
        "14": {
            "description": "System Error: Bad address",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "15": {
            "description": "System Error: Block device required",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "16": {
            "description": "System Error: Device or resource busy",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "17": {
            "description": "System Error: File exists",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "18": {
            "description": "System Error: Invalid cross-device link",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "19": {
            "description": "System Error: No such device",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "20": {
            "description": "System Error: Not a directory",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "21": {
            "description": "System Error: Is a directory",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "22": {
            "description": "System Error: Invalid argument",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "23": {
            "description": "System Error: Too many open files in system",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "24": {
            "description": "System Error: Too many open files",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "25": {
            "description": "System Error: Inappropriate ioctl for device",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "26": {
            "description": "System Error: Text file busy",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "27": {
            "description": "System Error: File too large",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "28": {
            "description": "System Error: No space left on device",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "29": {
            "description": "System Error: Illegal seek",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "30": {
            "description": "System Error: Read-only file system",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "31": {
            "description": "System Error: Too many links",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "32": {
            "description": "System Error: Broken pipe",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "33": {
            "description": "System Error: Numerical argument out of domain",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "34": {
            "description": "System Error: Numerical result out of range",
            "severity": "medium",
            "risk_score": 40,
            "category": "system"
        },
        "35": {
            "description": "System Error: Resource deadlock avoided",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "36": {
            "description": "System Error: File name too long",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "37": {
            "description": "System Error: No locks available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "38": {
            "description": "System Error: Function not implemented",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "39": {
            "description": "System Error: Directory not empty",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "40": {
            "description": "System Error: Too many levels of symbolic links",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "41": {
            "description": "System Error: Unknown error 41",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "42": {
            "description": "System Error: No message of desired type",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "43": {
            "description": "System Error: Identifier removed",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "44": {
            "description": "System Error: Channel number out of range",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "45": {
            "description": "System Error: Level 2 not synchronized",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "46": {
            "description": "System Error: Level 3 halted",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "47": {
            "description": "System Error: Level 3 reset",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "48": {
            "description": "System Error: Link number out of range",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "49": {
            "description": "System Error: Protocol driver not attached",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "50": {
            "description": "System Error: No CSI structure available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "51": {
            "description": "System Error: Level 2 halted",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "52": {
            "description": "System Error: Invalid exchange",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "53": {
            "description": "System Error: Invalid request descriptor",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "54": {
            "description": "System Error: Exchange full",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "55": {
            "description": "System Error: No anode",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "56": {
            "description": "System Error: Invalid request code",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "57": {
            "description": "System Error: Invalid slot",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "58": {
            "description": "System Error: Unknown error 58",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "59": {
            "description": "System Error: Bad font file format",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "60": {
            "description": "System Error: Device not a stream",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "61": {
            "description": "System Error: No data available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "62": {
            "description": "System Error: Timer expired",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "63": {
            "description": "System Error: Out of streams resources",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "64": {
            "description": "System Error: Machine is not on the network",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "65": {
            "description": "System Error: Package not installed",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "66": {
            "description": "System Error: Object is remote",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "67": {
            "description": "System Error: Link has been severed",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "68": {
            "description": "System Error: Advertise error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "69": {
            "description": "System Error: Srmount error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "70": {
            "description": "System Error: Communication error on send",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "71": {
            "description": "System Error: Protocol error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "72": {
            "description": "System Error: Multihop attempted",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "73": {
            "description": "System Error: RFS specific error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "74": {
            "description": "System Error: Bad message",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "75": {
            "description": "System Error: Value too large for defined data type",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "76": {
            "description": "System Error: Name not unique on network",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "77": {
            "description": "System Error: File descriptor in bad state",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "78": {
            "description": "System Error: Remote address changed",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "79": {
            "description": "System Error: Can not access a needed shared library",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "80": {
            "description": "System Error: Accessing a corrupted shared library",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "81": {
            "description": "System Error: .lib section in a.out corrupted",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "82": {
            "description": "System Error: Attempting to link in too many shared libraries",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "83": {
            "description": "System Error: Cannot exec a shared library directly",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "84": {
            "description": "System Error: Invalid or incomplete multibyte or wide character",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "85": {
            "description": "System Error: Interrupted system call should be restarted",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "86": {
            "description": "System Error: Streams pipe error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "87": {
            "description": "System Error: Too many users",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "88": {
            "description": "System Error: Socket operation on non-socket",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "89": {
            "description": "System Error: Destination address required",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "90": {
            "description": "System Error: Message too long",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "91": {
            "description": "System Error: Protocol wrong type for socket",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "92": {
            "description": "System Error: Protocol not available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "93": {
            "description": "System Error: Protocol not supported",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "94": {
            "description": "System Error: Socket type not supported",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "95": {
            "description": "System Error: Operation not supported",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "96": {
            "description": "System Error: Protocol family not supported",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "97": {
            "description": "System Error: Address family not supported by protocol",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "98": {
            "description": "System Error: Address already in use",
            "severity": "high",
            "risk_score": 80,
            "category": "system"
        },
        "99": {
            "description": "System Error: Cannot assign requested address",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "100": {
            "description": "System Error: Network is down",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "101": {
            "description": "System Error: Network is unreachable",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "102": {
            "description": "System Error: Network dropped connection on reset",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "103": {
            "description": "System Error: Software caused connection abort",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "104": {
            "description": "System Error: Connection reset by peer",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "105": {
            "description": "System Error: No buffer space available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "106": {
            "description": "System Error: Transport endpoint is already connected",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "107": {
            "description": "System Error: Transport endpoint is not connected",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "108": {
            "description": "System Error: Cannot send after transport endpoint shutdown",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "109": {
            "description": "System Error: Too many references: cannot splice",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "110": {
            "description": "System Error: Connection timed out",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "111": {
            "description": "System Error: Connection refused",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "112": {
            "description": "System Error: Host is down",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "113": {
            "description": "System Error: No route to host",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "114": {
            "description": "System Error: Operation already in progress",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "115": {
            "description": "System Error: Operation now in progress",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "116": {
            "description": "System Error: Stale file handle",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "117": {
            "description": "System Error: Structure needs cleaning",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "118": {
            "description": "System Error: Not a XENIX named type file",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "119": {
            "description": "System Error: No XENIX semaphores available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "120": {
            "description": "System Error: Is a named type file",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "121": {
            "description": "System Error: Remote I/O error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "122": {
            "description": "System Error: Disk quota exceeded",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "123": {
            "description": "System Error: No medium found",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "124": {
            "description": "System Error: Wrong medium type",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "125": {
            "description": "System Error: Operation canceled",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "126": {
            "description": "System Error: Required key not available",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "127": {
            "description": "System Error: Key has expired",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "128": {
            "description": "System Error: Key has been revoked",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "129": {
            "description": "System Error: Key was rejected by service",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "130": {
            "description": "System Error: Owner died",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "131": {
            "description": "System Error: State not recoverable",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "132": {
            "description": "System Error: Operation not possible due to RF-kill",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        },
        "133": {
            "description": "System Error: Memory page has hardware error",
            "severity": "low",
            "risk_score": 40,
            "category": "system"
        }
    },
    "service_patterns": {
        "ah00072": {
            "regex": "AH00072",
            "description": "Apache: Port bind failed. Check if port 80/443 is used by another app.",
            "severity": "high",
            "risk_score": 50,
            "category": "service"
        },
        "reverse_shell": {
            "regex": "nc .* -e|bash -i >& /dev/tcp",
            "description": "Possible reverse shell activity.",
            "severity": "critical",
            "risk_score": 98,
            "category": "security",
            "mitre": { "tactic": "Execution", "technique": "T1059" }
        },
        "ddos_indicator": {
            "regex": "SYN flood|possible SYN flooding",
            "description": "Potential DDoS attack indicator.",
            "severity": "critical",
            "risk_score": 95,
            "category": "network"
        },
        "disk_full": {
            "regex": "No space left on device",
            "description": "Disk is full.",
            "severity": "high",
            "risk_score": 75,
            "category": "system"
        },
        "docker_exit": {
            "regex": "container .* exited with code",
            "description": "Container stopped unexpectedly.",
            "severity": "medium",
            "risk_score": 60,
            "category": "container"
        },
        "address_already_in_use": {
            "regex": "Address already in use",
            "description": "Network conflict: Port is already bound.",
            "severity": "medium",
            "risk_score": 50,
            "category": "service"
        },
        "access_denied_for_user": {
            "regex": "Access denied for user",
            "description": "DB Error: Authentication failed.",
            "severity": "high",
            "risk_score": 75,
            "category": "service"
        },
        "can't_connect_to_local_mysql_server": {
            "regex": "Can't connect to local MySQL server",
            "description": "MySQL Error: Socket file missing.",
            "severity": "medium",
            "risk_score": 50,
            "category": "service"
        },
        "no_such_file_or_directory": {
            "regex": "No such file or directory",
            "description": "Path Error: A required file or binary is missing.",
            "severity": "medium",
            "risk_score": 50,
            "category": "service"
        },
        "permission_denied": {
            "regex": "Permission denied",
            "description": "Security Error: Check file/folder permissions.",
            "severity": "medium",
            "risk_score": 50,
            "category": "service"
        },
        "apache_error": {
            "regex": "AH[0-9]{5}",
            "description": "Apache HTTPD internal error code.",
            "severity": "critical",
            "risk_score": 90,
            "category": "service"
        },
        "kernel_panic": {
            "regex": "Kernel panic|Out of memory",
            "description": "Critical Linux Kernel event.",
            "severity": "critical",
            "risk_score": 95,
            "category": "system"
        },
        "postgresql_log": {
            "regex": "%{DATESTAMP:timestamp} %{TZ} %{DATA:user_id}",
            "description": "Postgres Log Pattern",
            "severity": "low",
            "risk_score": 30,
            "category": "service"
        },
        "redis_log": {
            "regex": "\\[%{POSINT:pid}\\] %{REDISTIMESTAMP:timestamp}",
            "description": "Redis Log Pattern",
            "severity": "low",
            "risk_score": 30,
            "category": "service"
        },
        "syslog_critical": {
            "regex": "syslog5424line",
            "description": "Linux Syslog 5424 Standard Line",
            "severity": "low",
            "risk_score": 30,
            "category": "service"
        }
    },
    "behavior_engine": {
    "enabled": true,
        "rules": {
        "high_exit_rate": {
            "metric": "process_exit", "threshold": 25, "window_sec": 60,
            "severity": "high", "risk_score": 75, "description": "High process crash rate detected."
        },
        "rapid_command_execution": {
            "metric": "command_spawn", "threshold": 50, "window_sec": 60,
            "severity": "high", "risk_score": 80, "description": "Unusual rapid command execution pattern."
        }
        }
    },
    "correlation_engine": {
    "enabled": true,
        "rules": {
        "ssh_bruteforce_then_success": {
            "sequence": ["ssh_failed_login", "ssh_login_success"],
            "within_sec": 120, "severity": "critical", "risk_score": 98,
            "description": "Brute force followed by successful login.",
            "mitre": { "tactic": "Credential Access", "technique": "T1059" }
        },
        "reverse_shell_after_privilege_escalation": {
            "sequence": ["privilege_escalation", "reverse_shell"],
            "within_sec": 180, "severity": "critical", "risk_score": 99,
            "description": "Privilege escalation followed by reverse shell.",
            "mitre": { "tactic": "Execution", "technique": "T1059" }
        }
        }
    },
    "incident_engine": {
    "enabled": true,
        "grouping": { "group_by": ["pid", "source_ip", "rule_name"], "time_window_sec": 300 },
        "incident_levels": {
        "low": { "threshold": 30 }, "medium": { "threshold": 60 }, "high": { "threshold": 80 }, "critical": { "threshold": 95 }
        },
        "auto_response": {
        "enabled": false,
        "actions": { "block_ip": false, "kill_process": false, "disable_user": false }
        }
    },
    "persistence_detection": {
        "enabled": true,
        "monitor_paths": ["/etc/cron", "/etc/systemd/system", "/usr/lib/systemd/system"]
    },
    "integrity_monitoring": {
        "enabled": true,
        "critical_paths": ["/bin", "/usr/bin", "/sbin", "/usr/sbin"]
    },
  "ioc": {
    "enabled": true,
        "match_strategy": "exact_or_partial",
        "malicious_ips": [], "malicious_domains": [], "file_hashes": []
  }
    
}